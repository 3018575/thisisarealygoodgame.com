// script.js

// Select player and items
const player = document.getElementById("player");
const items = document.querySelectorAll(".item");
const obstacles = document.querySelectorAll(".obstacle");

// Player position
let playerX = 10;
let playerY = 10;

// Item collection tracker
let collectedItems = 0;

// Key event listener for movement
document.addEventListener("keydown", (event) => {
  switch (event.key) {
    case "ArrowUp":
    case "w":
      movePlayer(0, -10);
      break;
    case "ArrowDown":
    case "s":
      movePlayer(0, 10);
      break;
    case "ArrowLeft":
    case "a":
      movePlayer(-10, 0);
      break;
    case "ArrowRight":
    case "d":
      movePlayer(10, 0);
      break;
  }
});

// Function to move the player and check for collisions
function movePlayer(dx, dy) {
  playerX += dx;
  playerY += dy;

  // Keep player within bounds
  if (playerX < 0) playerX = 0;
  if (playerX > 570) playerX = 570;
  if (playerY < 0) playerY = 0;
  if (playerY > 370) playerY = 370;

  player.style.left = playerX + "px";
  player.style.top = playerY + "px";

  // Check for item collection
  items.forEach((item) => {
    if (isCollision(player, item)) {
      item.style.display = "none"; // Hide the collected item
      collectedItems += 1;
      checkWin();
    }
  });

  // Check for obstacles
  obstacles.forEach((obstacle) => {
    if (isCollision(player, obstacle)) {
      alert("You hit an obstacle! Game over.");
      resetGame();
    }
  });
}

// Check if player has won
function checkWin() {
  if (collectedItems === items.length) {
    alert("You collected all items! You win!");
    resetGame();
  }
}

// Collision detection function
function isCollision(obj1, obj2) {
  const rect1 = obj1.getBoundingClientRect();
  const rect2 = obj2.getBoundingClientRect();

  return !(
    rect1.top > rect2.bottom ||
    rect1.bottom < rect2.top ||
    rect1.left > rect2.right ||
    rect1.right < rect2.left
  );
}

// Reset game function
function resetGame() {
  playerX = 10;
  playerY = 10;
  collectedItems = 0;
  player.style.left = playerX + "px";
  player.style.top = playerY + "px";

  // Reset items
  items.forEach((item) => {
    item.style.display = "block";
  });
}
